#!/bin/sh

. "${SCRIPTS_DIR:-$HOME/scripts}/scriptsrc"
. "$lib/var/config"
. "$lib/csv"
. "$lib/clipboard"

copy="false"
browser_cmd="xdg-open"

get_bookmarks () {
    keys "$bookmarks"
}

get_bookmark () {
    get_bookmarks | menu 2 "ï€®"
}

get_url () {
    value "$1" "$bookmarks"
}

open_bookmark () {
    if [ -n "$1" ]
    then
        $browser_cmd "$1"
    fi
}

copy_bookmark () {
    if [ -n "$1" ]
    then
        set_clipboard "$1"
        notify-send "Copied" "$1"
    fi
}

args=""

for arg in "$@"
do
    case "$arg" in
        "--copy") copy="true" ;;
        *) browser_cmd="$arg" ;;
    esac
done

bookmark_key=$(get_bookmark)

if [ "$copy" = "true" ]
then
    copy_bookmark "$(get_url "$bookmark_key")"
else
    open_bookmark "$(get_url "$bookmark_key")"
fi

